{% extends "layout.html" %}
{% block content %}
<div class="left-panel" id="leftPanel">
  <div class="panel-toggle" id="panelToggle">â—€</div>
  <div class="panel-resize-handle" id="resizeHandle"></div>
  <pre class="banner-text">
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                             â•‘
â•‘   â–ˆâ–ˆ â–ˆâ–ˆâ–ˆ  â–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆ     â•‘
â•‘   â–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆ    â–ˆâ–ˆ    â–ˆâ–ˆ    â•‘
â•‘   â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆ    â–ˆâ–ˆ    â–ˆâ–ˆ    â•‘
â•‘   â–ˆâ–ˆ â–ˆâ–ˆ  â–ˆâ–ˆâ–ˆ    â–ˆâ–ˆ    â–ˆâ–ˆ    â•‘
â•‘   â–ˆâ–ˆ â–ˆâ–ˆ   â–ˆâ–ˆ    â–ˆâ–ˆ    â–ˆâ–ˆ    â•‘
â•‘                             â•‘
â•‘   â–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆ   â–ˆâ–ˆâ–ˆ    â–ˆâ–ˆâ–ˆâ–ˆ   â•‘
â•‘     â–ˆâ–ˆ â–ˆâ–ˆ  â–ˆâ–ˆ â–ˆâ–ˆ  â–ˆâ–ˆ â–ˆâ–ˆ     â•‘
â•‘     â–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆ   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆ     â•‘
â•‘     â–ˆâ–ˆ â–ˆâ–ˆ  â–ˆâ–ˆ â–ˆâ–ˆ  â–ˆâ–ˆ â–ˆâ–ˆ     â•‘
â•‘     â–ˆâ–ˆ â–ˆâ–ˆ   â–ˆ â–ˆâ–ˆ  â–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆ   â•‘
â•‘                             â•‘
â•‘        v e r s i o n        â•‘
â•‘            2 . 0            â•‘
â•‘                             â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  </pre>
  <ul class="menu">
    <li><a href="/">âš¡ Scanner</a></li>
    <li><a href="/dashboard">â—£ Dashboard</a></li>
    <li><a href="/reports">â—ˆ Reports</a></li>
    <li class="menu-divider">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</li>
    <li><a href="/ddos">âš  DDoS Stress Test</a></li>
    <li class="menu-divider">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</li>
    <li>â—‰ Settings</li>
  </ul>
  <div class="credit-tag">
    <span class="credit-label">crafted by</span>
    <span class="credit-name">Gowtham Darkseid</span>
  </div>
</div>
<div class="main">
  <div class="breadcrumb">
    <a href="/reports">â† Back to Reports</a>
  </div>

  <div class="dashboard-header">
    <h1>&gt; Case Report: {{ case.case_id }}</h1>
    <div class="header-line">â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</div>
  </div>

  <div class="report-detail">
    <div class="detail-section">
      <h2>ğŸ“‹ Case Information</h2>
      <div class="info-grid">
        <div class="info-item">
          <span class="info-label">Case ID:</span>
          <span class="info-value case-id">{{ case.case_id }}</span>
        </div>
        <div class="info-item">
          <span class="info-label">Target Type:</span>
          <span class="badge badge-{{ case.target_type }}">{{ case.target_type|upper }}</span>
        </div>
        <div class="info-item">
          <span class="info-label">Target Value:</span>
          <span class="info-value">{{ case.target }}</span>
        </div>
        <div class="info-item">
          <span class="info-label">Investigator:</span>
          <span class="info-value">{{ case.investigator }}</span>
        </div>
        <div class="info-item">
          <span class="info-label">Reputation Score:</span>
          <span class="score-badge score-{{ 'high' if case.reputation.score > 50 else ('medium' if case.reputation.score > 20 else 'low') }}">
            {{ case.reputation.score }}
          </span>
        </div>
      </div>
    </div>

    <div class="detail-section">
      <h2>ğŸ¯ Reputation Analysis</h2>
      <div class="reputation-box">
        <div class="score-display">
          <div class="score-value">{{ case.reputation.score }}</div>
          <div class="score-label">Risk Score</div>
        </div>
        <div class="factors">
          <h3>Risk Factors:</h3>
          <ul>
            {% for factor in case.reputation.factors %}
            <li>{{ factor }}</li>
            {% endfor %}
          </ul>
        </div>
      </div>
    </div>

    <div class="detail-section">
      <h2>ğŸ” Investigation Results</h2>
      <div class="results-list">
        {% for result in case.results %}
        <div class="result-item">
          {% if result.platform %}
            <div class="result-header">
              <span class="platform-name">{{ result.platform|upper }}</span>
              <span class="status-badge status-{{ 'found' if result.exists else 'not-found' }}">
                {{ 'FOUND' if result.exists else 'NOT FOUND' }}
              </span>
            </div>
            {% if result.exists %}
            <div class="result-body">
              <div class="result-row">
                <span class="label">URL:</span>
                <a href="{{ result.url }}" target="_blank" class="link">{{ result.url }}</a>
              </div>
              <div class="result-row">
                <span class="label">Status Code:</span>
                <span class="value">{{ result.status_code }}</span>
              </div>
            </div>
            {% endif %}
          {% else %}
            <div class="result-header">
              <span class="platform-name">ADDITIONAL INFO</span>
            </div>
            <div class="result-body">
              <pre class="json-data">{{ result|tojson(indent=2) }}</pre>
            </div>
          {% endif %}
        </div>
        {% endfor %}
      </div>
    </div>

    <div class="detail-section">
      <h2>â±ï¸ Investigation Timeline</h2>
      <div class="timeline">
        {% for event in case.timeline %}
        <div class="timeline-item">
          <div class="timeline-marker"></div>
          <div class="timeline-content">
            <div class="timeline-time">{{ event.time }}</div>
            <div class="timeline-desc">{{ event.desc }}</div>
          </div>
        </div>
        {% endfor %}
      </div>
    </div>

    <div class="detail-actions">
      <button onclick="window.print()" class="action-btn">ğŸ–¨ï¸ Print Report</button>
      <button onclick="downloadJSON()" class="action-btn">ğŸ’¾ Download JSON</button>
      <a href="/reports" class="action-btn">â† Back to Reports</a>
    </div>
  </div>
</div>

<script id="case-data" type="application/json">{{ case|tojson|safe }}</script>
<script>
function downloadJSON() {
  const dataScript = document.getElementById('case-data');
  const data = JSON.parse(dataScript.textContent);
  const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = data.case_id + '.json';
  a.click();
  URL.revokeObjectURL(url);
}
</script>
{% endblock %}
